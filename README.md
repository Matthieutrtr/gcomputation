gcomputation: an R Package for Estimating Marginal Effects Using G-Computation

================

## Description

The R package ‘gcomputation’ provides functions to compute G-Computation (GC) to estimate marginal effects. It has both estimating marginal logistic functions and marginal survival functions regarding two exposures. The package implements GC with various working models or algorithms, referred to as Q-models.

## Key Features

The package supports several methods to construct the Q-model:
*   "all": Uses a usual logistic or Cox model, incorporating all variables provided in the formula.
*   "lasso": Implements L1 regularization for logistic or Cox regression, which can perform predictor selection. It uses the glmnet package.
*   "ridge": Applies L2 regularization for logistic or Cox regression, also utilizing the glmnet package. This is equivalent to Elastic Net with an alpha value of 0.
*   "elasticnet": Combines both L1 and L2 regularizations for logistic or Cox regression, also using the glmnet package. The alpha parameter controls the mix between L1 and L2, typically ranging from 0 to 1.
*   "aic": Performs forward selection for logistic or Cox regression based on the Akaike Information Criterion (AIC), using stepAIC.
*   "bic": Performs forward selection for logistic or Cox regression based on the Bayesian Information Criterion (BIC), also using stepAIC with `k=log(nrow(data))`.

The package offers estimation of three types of marginal effects:
*   "ATE" (Average Treatment effect on the entire population): The marginal effect if the entire sample were treated versus entirely untreated.
*   "ATT" (Average Treatment effect on the treated): The marginal effect if the treated patients (group = 1) would have been untreated.
*   "ATU" (Average Treatment effect on the untreated): The marginal effect if the untreated patients (group = 0) would have been treated.

S3 methods are included for objects generated by gc_logistic and gc_survival functions, allowing for:
*   `print`: To print a summary of the results.
*   `summary`: To provide a more detailed summary of the prognostic capacities, including confidence intervals.
*   `plot`: To visualize the results through calibration plots or effect-specific plots (proportion for logistic, survival curve for survival).

The package also supports bootstrapping for confidence interval estimation, with options for "bcv" (default) or "boot" types and a default of 500 bootstrap resamples. Users can also control whether tuning parameters are estimated within each bootstrap iteration or on the total population.

## Basic Usage
For a binary outcome:
``` r
data("dataPROPHYVAP")

dataPROPHYVAP$VAP_num <- ifelse(dataPROPHYVAP$VAP == "Yes",1,0)
dataPROPHYVAP$GROUP_num <- ifelse(dataPROPHYVAP$GROUP == "Placebo",0,1)


formula <- formula(VAP_EARLY_num ~ GROUP_num * AGE + SEX + BMI + DIABETES)

gc1 <- gc_logistic(formula=formula, method="ridge", data=dataPROPHYVAP, group="GROUP_num",
              param.tune=NULL, boot.type="bcv", cv=10, boot.number=500,  effect="ATE",
              progress=TRUE, boot.tune = TRUE, seed=8471)

print(gc1)
summary(gc1, ci.type="norm")
plot(gc1)
```

For a survival outcome:
``` r
data(dataPROPHYVAP)

dataPROPHYVAP$DEATH_num <- ifelse(dataPROPHYVAP$DEATH == "Yes",1,0)
dataPROPHYVAP$GROUP_num <- ifelse(dataPROPHYVAP$GROUP == "Placebo",0,1)

formula <- formula(Surv(TIME_DEATH, DEATH_num) ~ GROUP_num * AGE + SEX + BMI + DIABETES)

gc1 <- gc_survival(formula=formula, method="lasso", data=dataPROPHYVAP, group="GROUP_num",
              param.tune=NULL, boot.type="bcv", cv=10, boot.number=500,  effect="ATE",
              progress=TRUE , pro.time=10, boot.tune = TRUE, seed = 5312)

print(gc1)
summary(gc1, ci.type="perc")
plot(gc1)
```

## Installation

To install the version from GitHub:

``` r
remotes::install_github("chupverse/gcomputation")
```

## Reporting bugs

You can report any issues at this
[link](https://github.com/chupverse/gcomputation/issues).
